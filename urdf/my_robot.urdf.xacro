<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="my_robot">

    <xacro:include filename="gazebo_control.xacro" />

    <material name="white">
        <color rgba="1 1 1 1" />
    </material>

    <material name="blue">
        <color rgba="0.0 0.0 1.0 1.0"/> <!-- Pure blue -->
    </material>

    <material name="grey">
        <color rgba="0.2 0.2 0.2 1.0"/>
    </material>

    <material name="light_grey">
    <color rgba="0.7 0.7 0.7 1.0"/>
    </material>

    <!-- Bright Silver (metallic look) -->
    <material name="silver">
        <color rgba="0.75 0.75 0.75 1.0"/>
    </material>


    <material name="black">
        <color rgba="0 0 0 1" />
    </material>

    <!-- ========== ROBOT DIMENSIONS ========== -->
  
    <xacro:property name="base_length" value="0.074" />    
    <xacro:property name="base_width" value="0.136" />     
    <xacro:property name="base_height" value="0.043" />     
    
    <xacro:property name="wheel_radius" value="0.0345" />    
    <xacro:property name="wheel_width" value="0.027" />     
    
    
    <!-- Caster wheel position - at the back -->
    <xacro:property name="caster_x_offset" value="-0.05" /> <!-- -base_length/2 = -78mm -->
    <xacro:property name="fcaster_x_offset" value="0.05" /> <!-- -base_length/2 = -78mm -->
    <xacro:property name="caster_z_offset" value="-0.030" /> <!-- below base -->



    <!-- ========== CYLINDER MACRO ========== -->
    <xacro:macro name="vertical_cylinder" params="name x y z color">
        <link name="${name}">
        <visual>
            <geometry>
            <cylinder length="0.038" radius="0.0035"/>
            </geometry>
            <material name="${color}"/>
        </visual>
        <collision>
            <geometry>
            <cylinder length="0.038" radius="0.0035"/>
            </geometry>
        </collision>
        <inertial>
            <mass value="0.05"/>
            <inertia ixx="0.00001" ixy="0.0" ixz="0.0" iyy="0.00001" iyz="0.0" izz="0.00001"/>
        </inertial>
        </link>

        <joint name="${name}_joint" type="fixed">
        <parent link="base_link"/>
        <child link="${name}"/>
        <origin xyz="${x} ${y} ${z}" rpy="0 0 0"/>
        </joint>
    </xacro:macro>

  
    <!-- ========== BASE LINK ========== -->
    <link name="base_link">
        <visual>

        <geometry>
            <box size="${base_length} ${base_width} ${base_height}"/>
        </geometry>
        <material name="black"/>
        </visual>
        
        <collision>
        <geometry>
            <box size="${base_length} ${base_width} ${base_height}"/>
        </geometry>
        </collision>
        
        <inertial>
        <mass value="1.0"/>  <!-- 1kg mass -->
        <inertia ixx="0.001" ixy="0.0" ixz="0.0" 
                iyy="0.001" iyz="0.0" izz="0.001"/>
        </inertial>
    </link>
    <gazebo reference="base_link">
        <material>Gazebo/Black</material>
    </gazebo>


    <!-- ========== TOP PLATE ========== -->
    <link name="top_plate">
    <visual>
        <geometry>
        <box size="0.154 0.136 0.0035"/>  
        </geometry>
        <material name="light_grey"/>
    </visual>
    
    <collision>
        <geometry>
        <box size="0.154 0.136 0.0035"/>  
        </geometry>
    </collision>
    
    <inertial>
        <mass value="0.05"/>  <!-- 50g for the block -->
        <inertia ixx="0.0001" ixy="0.0" ixz="0.0" 
                iyy="0.0001" iyz="0.0" izz="0.0001"/>
    </inertial>
    </link>

    <joint name="top_Plate_joint" type="fixed">
    <parent link="base_link"/>  <!-- Attached to main chassis -->
    <child link="top_plate"/>
    <origin xyz="0 0 0.060" rpy="0 0 0"/>
    </joint>
    <gazebo reference="top_plate">
        <material>Gazebo/Grey</material>
    </gazebo>

    
    <!-- Front Left -->
    <xacro:vertical_cylinder name="front_left_cylinder" x="0.065" y="0.062" z="0.040" color="silver"/>
    <!-- Front Right -->
    <xacro:vertical_cylinder name="front_right_cylinder" x="0.065" y="-0.062" z="0.040" color="silver"/>
    <!-- Rear Left -->
    <xacro:vertical_cylinder name="rear_left_cylinder" x="-0.065" y="0.062" z="0.040" color="silver"/>
    <!-- Rear Right -->
    <xacro:vertical_cylinder name="rear_right_cylinder" x="-0.065" y="-0.062" z="0.040" color="silver"/>
    <gazebo reference="front_left_cylinder">
        <material>Gazebo/Silver</material>
    </gazebo>
    <gazebo reference="front_right_cylinder">
        <material>Gazebo/Silver</material>
    </gazebo>
    <gazebo reference="rear_left_cylinder">
        <material>Gazebo/Silver</material>
    </gazebo>
    <gazebo reference="rear_left_cylinder">
        <material>Gazebo/Silver</material>
    </gazebo>



    <!-- ========== FRONT BLOCK ========== -->
    <link name="front_block">
    <visual>
        <geometry>
        <box size="0.040 0.196 0.043"/>  <!-- 40mm x 30mm x 43mm -->
        </geometry>
        <material name="black"/>
    </visual>
    
    <collision>
        <geometry>
        <box size="0.040 0.030 0.043"/>
        </geometry>
    </collision>
    
    <inertial>
        <mass value="0.05"/>  <!-- 50g for the block -->
        <inertia ixx="0.0001" ixy="0.0" ixz="0.0" 
                iyy="0.0001" iyz="0.0" izz="0.0001"/>
    </inertial>
    </link>

    <joint name="front_block_joint" type="fixed">
    <parent link="base_link"/>  <!-- Attached to main chassis -->
    <child link="front_block"/>
    <origin xyz="0.057 0.0 0" rpy="0 0 0"/>
    </joint>
    <gazebo reference="front_block">
        <material>Gazebo/Black</material>
    </gazebo>

     <!-- ========== REAR BLOCK ========== -->
    <link name="rear_block">
    <visual>
        <geometry>
        <box size="0.040 0.196 0.043"/>  
        </geometry>
        <material name="black"/>
    </visual>
    
    <collision>
        <geometry>
        <box size="0.040 0.030 0.043"/>
        </geometry>
    </collision>
    
    <inertial>
        <mass value="0.05"/>  <!-- 50g for the block -->
        <inertia ixx="0.0001" ixy="0.0" ixz="0.0" 
                iyy="0.0001" iyz="0.0" izz="0.0001"/>
    </inertial>
    </link>

    <joint name="rear_block_joint" type="fixed">
    <parent link="base_link"/>  <!-- Attached to main chassis -->
    <child link="rear_block"/>
    <origin xyz="-0.057 0.0 0" rpy="0 0 0"/>
    </joint>
    <gazebo reference="rear_block">
        <material>Gazebo/Black</material>
    </gazebo>

    <!-- ========== LEFT WHEEL ========== -->
    <link name="left_wheel">
        <visual>
        <geometry>
            <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
        </geometry>
        <material name="blue"/>
        </visual>
        
        <collision>
        <geometry>
            <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
        </geometry>
        </collision>
        
        <inertial>
        <mass value="0.1"/>  <!-- 100g per wheel -->
        <inertia ixx="0.000036" ixy="0.0" ixz="0.0" 
                iyy="0.000036" iyz="0.0" izz="0.000060"/>
        </inertial>
    </link>

    <joint name="left_wheel_joint" type="continuous">
        <parent link="base_link"/>
        <child link="left_wheel"/>
        <origin xyz="0 0.0815 -0.01" rpy="-${pi/2} 0 0"/>
        <axis xyz="0 0 1"/>
    </joint>
    <gazebo reference="left_wheel">
        <material>Gazebo/Blue</material>
    </gazebo>

    <!-- ========== RIGHT WHEEL ========== -->
    <link name="right_wheel">
        <visual>
        <geometry>
            <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
        </geometry>
        <material name="blue"/>
        </visual>
        
        <collision>
        <geometry>
            <cylinder radius="${wheel_radius}" length="${wheel_width}"/>
        </geometry>
        </collision>
        
        <inertial>
        <mass value="0.1"/>  <!-- 100g wheel -->
        <inertia ixx="0.000036" ixy="0.0" ixz="0.0" 
                iyy="0.000036" iyz="0.0" izz="0.000060"/>
        </inertial>
    </link>

    <joint name="right_wheel_joint" type="continuous">
        <parent link="base_link"/>
        <child link="right_wheel"/>
        <origin xyz="0 -0.0815 -0.01" rpy="${pi/2} 0 0"/>
        <axis xyz="0 0 -1"/>
    </joint>
    <gazebo reference="right_wheel">
        <material>Gazebo/Blue</material>
    </gazebo>

    <!-- ========== CASTER WHEEL ========== -->
    <link name="caster_wheel">
        <visual>
        <geometry>
            <sphere radius="0.015"/>  <!-- 15mm radius -->
        </geometry>
        <material name="grey"/>
        </visual>
        
        <collision>
        <geometry>
            <sphere radius="0.015"/>
        </geometry>
        </collision>
        
        <inertial>
        <mass value="0.05"/>  <!-- 50g -->
        <inertia ixx="0.00001" ixy="0.0" ixz="0.0" 
                iyy="0.00001" iyz="0.0" izz="0.00001"/>
        </inertial>
    </link>

    <joint name="caster_wheel_joint" type="fixed">
        <parent link="base_link"/>
        <child link="caster_wheel"/>
        <origin xyz="${caster_x_offset} 0 ${caster_z_offset}" rpy="0 0 0"/>
    </joint>
    <gazebo reference="caster_wheel">
        <material>Gazebo/Silver</material>
    </gazebo>

</robot>